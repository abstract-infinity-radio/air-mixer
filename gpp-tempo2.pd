#N canvas 1785 180 2000 1400 10;
#X obj 289 312 timer;
#X msg 165 313 1;
#X obj 165 344 gpp-adder3 0;
#X obj 269 495 expr $f2 * 1000 / $f1 * 60;
#X obj 178 65 inlet;
#X obj 228 591 outlet;
#X obj 502 31 cnv 10 114 22 empty empty AIR 36 6 1 22 -66577 -262144
0;
#X text 502 56 Gregor Pir≈° 2022;
#X obj 523 597 outlet;
#X floatatom 132 473 5 0 0 0 - - -;
#X obj 53 156 loadbang;
#X floatatom 445 271 10 0 0 0 - - -;
#X obj 298 239 t b b;
#X obj 313 454 t 0 0;
#X msg 53 180 tempo 1 msec;
#X obj 377 453 t f f;
#X obj 207 238 t b b b b b;
#X obj 281 65 inlet;
#X text 178 44 pulse;
#X text 257 15 set listen-at-the-beginning mode :: bang this and tempo2
will wait until the beating starts, f 35;
#N canvas 0 180 1600 1400 \$0-WAITER 0;
#X msg 343 129 1;
#X obj 351 167 gpp-adder3 0;
#X obj 349 197 moses 2;
#X obj 331 99 inlet;
#X obj 450 97 inlet;
#X obj 343 237 outlet;
#X obj 399 236 outlet;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 5 0;
#X connect 2 1 6 0;
#X connect 3 0 0 0;
#X connect 4 0 1 1;
#X restore 210 153 pd \$0-WAITER;
#X obj 306 593 outlet;
#X obj 354 372 gpp-birot;
#X obj 354 414 expr 1000 / ($f1 -$f2) * 60;
#X msg 404 341 0;
#X text 525 172 TODO: - reset average measurement and start again -
detect big changes;
#X obj 380 594 outlet;
#X obj 381 539 expr 100 * abs(($f1 - $f2) / $f1);
#X obj 279 126 bang;
#X obj 281 99 route waitstart resetav;
#X text 327 125 for resetaverage it would be neccessary to set timer
to beats*current_timing;
#X text 625 28 gpp-tempo2 :: measure tempo of bang pulse :: in1 = bang
pulse in2 = reset to listen-at-the beginning mode :: out1 = current
tempo average :: out 2 = actual (dynamic) tempo :: out3 = percent deviation
from average tempo :: out4 = current beat number;
#X text 212 615 tempo AVG;
#X text 294 616 tempo DYN;
#X text 369 617 percent deviation;
#X text 523 617 current beat number;
#X connect 0 0 3 0;
#X connect 0 0 11 0;
#X connect 0 0 22 0;
#X connect 1 0 2 0;
#X connect 2 0 9 0;
#X connect 2 0 15 0;
#X connect 3 0 5 0;
#X connect 3 0 27 0;
#X connect 4 0 20 0;
#X connect 10 0 14 0;
#X connect 12 0 1 0;
#X connect 12 1 0 1;
#X connect 13 0 5 0;
#X connect 13 1 8 0;
#X connect 14 0 0 0;
#X connect 15 0 8 0;
#X connect 15 1 3 1;
#X connect 16 0 1 0;
#X connect 16 1 0 1;
#X connect 16 2 13 0;
#X connect 16 3 2 1;
#X connect 16 3 24 0;
#X connect 16 4 0 0;
#X connect 17 0 29 0;
#X connect 20 0 16 0;
#X connect 20 1 12 0;
#X connect 22 0 23 0;
#X connect 22 1 23 1;
#X connect 23 0 21 0;
#X connect 23 0 27 1;
#X connect 24 0 22 1;
#X connect 27 0 26 0;
#X connect 28 0 20 1;
#X connect 29 0 28 0;
#X coords 0 700 1 699 150 70 0;
