#N canvas 1282 495 2124 1203 12;
#X obj 135 11 inlet~;
#X obj 1124 85 aubio/aubiotempo~-help;
#X obj 134 306 gpp-tempo2;
#X msg 201 271 waitstart;
#X obj 230 170 t b b b;
#X obj 544 29 inlet;
#X text 536 7 ext control;
#N canvas 807 358 2880 1453 SEPACHAIN-ANALYSIS 1;
#N canvas 1040 770 2588 1288 \$0-SC-CONTROL 1;
#X obj 402 256 outlet;
#X msg 402 81 clear;
#X msg 625 51 flush;
#X text 617 22 rounding factor;
#X msg 623 1 reduce 10;
#X obj 427 45 loadbang;
#X obj 403 17 r \$0-TRIGSTART;
#X obj 44 25 inlet;
#X obj 600 262 outlet;
#X obj 821 4 loadbang;
#X text 619 74 flush fifostat;
#X obj 44 256 outlet;
#X msg 821 62 8;
#X msg 923 112 0.8;
#X obj 811 269 outlet;
#X text 801 298 the rest of commands;
#X msg 243 184 fifosize \$1;
#X msg 470 209 fiforange \$1 \$2;
#X obj 281 428 s \$0-FIFOSTAT-SIZE;
#X text 277 448 for ywrite;
#X obj 821 98 t f f f;
#X obj 533 435 s \$0-FIFOSTAT-RANGE;
#X obj 821 33 t f b b;
#X obj 536 467 r \$0-FIFOSTAT-RANGE;
#X msg 600 222 threshold \$1;
#X obj 45 59 route fifosize transition_threshold fiforange;
#X obj 590 370 s \$0-TRANSITION-THRESHOLD;
#X floatatom 74 192 5 0 0 0 - - -;
#X msg 986 114 list 0 500;
#X connect 1 0 0 0;
#X connect 2 0 0 0;
#X connect 4 0 0 0;
#X connect 5 0 1 0;
#X connect 6 0 1 0;
#X connect 7 0 25 0;
#X connect 9 0 22 0;
#X connect 12 0 20 0;
#X connect 13 0 24 0;
#X connect 13 0 26 0;
#X connect 16 0 0 0;
#X connect 17 0 0 0;
#X connect 20 0 11 0;
#X connect 20 1 16 0;
#X connect 20 2 18 0;
#X connect 22 0 12 0;
#X connect 22 1 13 0;
#X connect 22 2 28 0;
#X connect 24 0 8 0;
#X connect 25 0 16 0;
#X connect 25 0 11 0;
#X connect 25 0 18 0;
#X connect 25 0 27 0;
#X connect 25 1 24 0;
#X connect 25 1 26 0;
#X connect 25 2 17 0;
#X connect 25 2 21 0;
#X connect 25 3 14 0;
#X connect 28 0 21 0;
#X connect 28 0 17 0;
#X restore 381 107 pd \$0-SC-CONTROL;
#N canvas 85 335 3387 1770 \$0-WRITE-YAML 0;
#X obj 618 70 inlet;
#X obj 684 67 inlet;
#X obj 764 64 inlet;
#X obj 880 63 inlet;
#X obj 765 208 route bang float;
#X msg 951 711 outfile \$1;
#X obj 951 627 r \$0-OUTFILE;
#X obj 1548 31 r \$0-TRIGSTART;
#X obj 857 737 gpp-ywrite, f 11;
#N canvas 2015 646 1721 804 \$0-COUNT-BEATS-RECORDING 0;
#X obj 53 135 gpp-adder3 0;
#X obj 50 25 inlet;
#X msg 54 106 1;
#X obj 54 195 outlet;
#X obj 95 25 r \$0-TRIGSTART;
#X obj 168 137 gpp-adder3 0;
#X obj 51 62 t b b;
#X obj 224 29 inlet;
#X obj 169 209 s \$0-TEMPO-AVERAGE-RECORDING;
#X obj 168 177 expr $f2 / $f1;
#X connect 0 0 3 0;
#X connect 0 0 9 0;
#X connect 1 0 6 0;
#X connect 2 0 0 0;
#X connect 4 0 0 1;
#X connect 4 0 5 1;
#X connect 5 0 9 1;
#X connect 6 1 2 0;
#X connect 7 0 5 0;
#X connect 9 0 8 0;
#X restore 588 689 pd \$0-COUNT-BEATS-RECORDING;
#X obj 608 116 print A;
#X obj 680 113 print B;
#X obj 1011 36 r \$0-TRIGEND;
#X obj 421 214 / 1000;
#X obj 421 240 gpp-display-seconds;
#X obj 392 99 inlet;
#X obj 854 600 r \$0-YW;
#X obj 819 281 list prepend \$0;
#X obj 762 324 \$0;
#X obj 762 294 t b;
#X obj 880 111 bang;
#X text 765 30 PRECEDENCE: 1 => analysis, f 17;
#X text 613 30 PRECENDENCE: 2 => beat-tempo, f 19;
#X text 390 60 precendence 3 => beat-abstime, f 22;
#X obj 1570 96 \$0;
#X obj 931 600 r \$0-YWCONTROL;
#X obj 1247 67 t b;
#X obj 1248 281 list prepend \$0;
#X msg 1247 93 1;
#X obj 1247 120 gpp-adder3 0;
#X obj 1246 38 r \$0-TRIGREGION;
#X obj 880 148 s \$0-TRIGREGION;
#X text 877 168 region trigger;
#X msg 763 375 \; \$1-YW is_elusive 1 \;;
#N canvas 188 180 1617 839 \$0-COUNT-BEATS-REGION 0;
#X obj 50 124 gpp-adder3 0;
#X obj 50 47 inlet;
#X msg 50 94 1;
#X obj 50 183 outlet;
#X obj 153 48 r \$0-TRIGSTART;
#X obj 352 133 gpp-adder3 0;
#X obj 352 51 inlet;
#X obj 352 173 expr $f2 / $f1;
#X obj 278 15 r \$0-TRIGREGION;
#X obj 353 205 s \$0-TEMPO-AVERAGE-REGION;
#X connect 0 0 3 0;
#X connect 0 0 7 0;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 4 0 0 1;
#X connect 4 0 5 1;
#X connect 5 0 7 1;
#X connect 6 0 5 0;
#X connect 7 0 9 0;
#X connect 8 0 0 1;
#X connect 8 0 5 1;
#X restore 627 499 pd \$0-COUNT-BEATS-REGION;
#X obj 608 575 list prepend \$0;
#X obj 763 103 t b a;
#X obj 715 210 \$0;
#X obj 477 214 s \$0-ABSTIME;
#X obj 328 305 list prepend \$0;
#X obj 330 270 list append;
#X text 936 468 note: PRECEDENCE: the \$0-ABSTIME in TRIGREGION has
to be the old one \, because whole header is done in advance. at the
moment of region change \, the whole region is already analyzed and
the header is written. the real start here ist the 'stale' ABSTIME
value \, for instance if region 1 has been created at 1000 ms \, its
start is 0 ms \, which is previous value;
#X obj 1349 68 s \$0-REGIONS_NUM;
#X obj 1520 32 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 1216 36 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 1544 253 sel 1;
#X obj 1248 149 t f f f;
#X obj 743 78 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X msg 572 67 13;
#X msg 402 160 3123;
#X text 328 403 (close beat subhash);
#X text 1505 785 close previous region beats' sublist and region hash
for all regions > 1, f 18;
#X obj 1549 60 t b b b;
#X text 1503 548 [% regions=> [@ [% ... beats=> [@ [% .... %] [% ...
%];
#X text 1505 661 end: @] \, %] \, @] \;;
#X text 1503 690 recheader=> [%;
#X text 1508 727 %] %];
#X text 1504 595 trigregion: @] \, %];
#N canvas 877 496 2574 1609 \$0-END 0;
#X obj 63 56 t b;
#X obj 63 99 f;
#X obj 91 75 r \$0-REGIONS_NUM;
#X obj 63 143 list append;
#X text 234 339 write recording header data;
#X obj 55 502 list prepend \$0;
#X obj 54 528 t b a;
#X obj 54 555 print --- END;
#X obj 60 277 list append;
#X obj 63 23 inlet;
#X obj 55 351 list append;
#X obj 128 377 r \$0-TEMPO-AVERAGE-RECORDING;
#X obj 54 409 list append;
#X obj 63 204 list append;
#X obj 138 172 r \$0-FIFOSTAT-SIZE;
#X obj 54 453 list append;
#X obj 258 420 r \$0-FIFOSTAT-RANGE;
#X obj 269 498 print ]]]FIFOSTAT-RANGE;
#X obj 127 319 r \$0-AUBIO-THRESHOLD;
#X obj 135 245 r \$0-TRANSITION-THRESHOLD;
#X obj 136 119 r \$0-NUMBEATS;
#X msg 86 594 \; \$1-YW @] \, %] \, @] \; \$1-YW header => \, [% \;
\$1-YW regions \$2 \, beats \$3 \, fifostat_size \$4 \, transition_threshold
\$5 \, aubio_threshold \$6 \, average_tempo \$7 \, fifostat_range_from
\$8 \, fifostat_range_to \$9 \; \$1-YW %] \, %] \;, f 163;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 1 1;
#X connect 3 0 13 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 6 1 21 0;
#X connect 8 0 10 0;
#X connect 9 0 0 0;
#X connect 10 0 12 0;
#X connect 11 0 12 1;
#X connect 12 0 15 0;
#X connect 13 0 8 0;
#X connect 14 0 13 1;
#X connect 15 0 5 0;
#X connect 16 0 15 1;
#X connect 16 0 17 0;
#X connect 18 0 10 1;
#X connect 19 0 8 1;
#X connect 20 0 3 1;
#X restore 1012 82 pd \$0-END;
#X obj 589 245 t b f b f f;
#X obj 1589 278 list append;
#X obj 1660 247 r \$0-TEMPO-AVERAGE-REGION;
#X obj 1596 388 list prepend \$0;
#X obj 476 764 list prepend \$0;
#X obj 245 508 gpp-display-seconds;
#X obj 245 481 / 1000;
#X obj 129 426 gpp-trap2;
#X obj 186 343 r \$0-TRIGREGION;
#X msg 187 394 1;
#X obj 396 186 t f f f f;
#X obj 1686 291 r \$0-REGION-TIME;
#X obj 1598 323 list append;
#X obj 1598 355 list append;
#X obj 1686 323 r \$0-REGION-TIME-MS;
#X obj 281 578 s \$0-REGION-TIME;
#X obj 129 572 s \$0-REGION-TIME-MS;
#X obj 970 741 print REGISTERED_OUTFILE;
#X obj 588 715 s \$0-NUMBEATS;
#X obj 951 669 gpp-add-extension \$1;
#X msg 1570 132 \; \$1-YWCONTROL clear \; \$1-YW [% \, region => \,
[@ \;;
#X msg 715 239 \; \$1-YW beat => \, [@ \;;
#X msg 819 313 \; \$1-YW is_elusive 0 \; \$1-YW prevalent_tempo \$2
\;;
#X msg 608 603 \; \$1-YW [% \, tempo \$2 \;;
#X obj 1437 135 s \$0-TRIGREGION;
#X obj 1544 230 > 1;
#X text -13 104 =>YW[TIMECODE]: 0 ---: bang =>YW[TRACK_A]: 0 =>YW[TIMECODE]:
0 ---: bang, f 26;
#X msg 328 337 \; \$1-YW at_ms \$2 \; \$1-YW at_time \$3 \; \$1-YW
%] \;;
#X msg 1505 431 \; \$1-YW @] \; \$1-YW average_tempo \$2 \; \$1-YW
at_time \$3 \; \$1-YW at_ms \$4 \; \$1-YW %] \;;
#X msg 476 796 \; \$1-YW id \$2 \;;
#X msg 1248 312 \; \$1-YW [% \, id \$2 \;;
#X connect 0 0 59 0;
#X connect 1 0 59 0;
#X connect 2 0 36 0;
#X connect 3 0 20 0;
#X connect 4 0 19 0;
#X connect 4 1 17 0;
#X connect 5 0 8 1;
#X connect 6 0 78 0;
#X connect 7 0 52 0;
#X connect 9 0 63 0;
#X connect 9 0 77 0;
#X connect 12 0 58 0;
#X connect 13 0 14 0;
#X connect 14 0 40 1;
#X connect 15 0 69 0;
#X connect 16 0 8 0;
#X connect 17 0 81 0;
#X connect 18 0 33 0;
#X connect 19 0 18 0;
#X connect 20 0 31 0;
#X connect 24 0 79 0;
#X connect 25 0 8 1;
#X connect 26 0 28 0;
#X connect 27 0 89 0;
#X connect 28 0 29 0;
#X connect 29 0 46 0;
#X connect 30 0 26 0;
#X connect 35 0 82 0;
#X connect 36 0 37 0;
#X connect 36 1 4 0;
#X connect 37 0 80 0;
#X connect 39 0 86 0;
#X connect 40 0 39 0;
#X connect 43 0 52 0;
#X connect 44 0 26 0;
#X connect 45 0 60 0;
#X connect 46 0 27 0;
#X connect 46 1 84 0;
#X connect 46 2 42 0;
#X connect 47 0 36 0;
#X connect 48 0 59 0;
#X connect 49 0 69 0;
#X connect 52 1 24 0;
#X connect 52 2 29 1;
#X connect 59 0 9 0;
#X connect 59 1 35 0;
#X connect 59 2 34 0;
#X connect 59 3 9 1;
#X connect 59 4 34 1;
#X connect 60 0 71 0;
#X connect 61 0 60 1;
#X connect 62 0 87 0;
#X connect 63 0 88 0;
#X connect 64 0 74 0;
#X connect 65 0 64 0;
#X connect 66 0 65 0;
#X connect 66 0 75 0;
#X connect 67 0 68 0;
#X connect 68 0 66 1;
#X connect 69 0 66 0;
#X connect 69 1 40 0;
#X connect 69 2 13 0;
#X connect 69 3 38 0;
#X connect 70 0 71 1;
#X connect 71 0 72 0;
#X connect 72 0 62 0;
#X connect 73 0 72 1;
#X connect 78 0 5 0;
#X connect 78 0 76 0;
#X connect 84 0 45 0;
#X restore 271 470 pd \$0-WRITE-YAML;
#X floatatom 419 8 5 0 0 0 BEAT-TEMPO - -;
#X floatatom 54 12 20 0 0 0 BEAT-ABSTIME - -;
#X obj 121 252 list store;
#X msg 147 224 prepend \$1;
#X obj 638 100 r \$0-TRIGSTART;
#X obj 765 100 r \$0-TRIGEND;
#X obj 765 154 t b;
#X obj 125 89 unpack f f f;
#X floatatom 294 14 5 0 0 0 BEAT-DURATION - -;
#X obj 125 48 inlet;
#X obj 102 532 print =>YW[TIMECODE];
#X obj 174 573 print =>YW[TRACK_A];
#X obj 205 604 print =>YW[TRACK_B];
#X obj 337 664 print =>YW[OUTPUT_TOGGLE];
#X msg 670 212 init;
#X obj 116 164 t b f;
#X obj 84 322 t b b a;
#X obj 33 360 print ---;
#X obj 105 426 f 0;
#X obj 123 376 route float;
#X obj 380 76 inlet;
#X text 502 95 other commands if / when any, f 11;
#X floatatom 362 251 5 0 0 0 - - -;
#X text 764 200 =>YW[TIMECODE]: 0 ---: bang =>YW[TRACK_A]: 0 =>YW[TIMECODE]:
0 ---: bang, f 21;
#X obj 121 284 list split 10;
#X obj 536 493 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 255 630 print =>YW[PREVALENT]:::::::::::::::::::;
#X obj 646 156 t b b b;
#X msg 199 337 0;
#X obj 103 460 sel 0;
#X obj 492 438 print =>YW[TEMPO_STABILITY]------>;
#X msg 490 403 \$1 / \$2;
#X obj 323 332 gpp-sepachain 10 0 500 1;
#X connect 0 0 24 0;
#X connect 0 0 26 1;
#X connect 0 1 34 1;
#X connect 0 2 34 2;
#X connect 4 0 26 0;
#X connect 5 0 4 0;
#X connect 6 0 29 0;
#X connect 7 0 8 0;
#X connect 9 0 17 0;
#X connect 9 0 3 0;
#X connect 9 1 10 0;
#X connect 9 2 2 0;
#X connect 9 2 34 0;
#X connect 11 0 9 0;
#X connect 16 0 34 2;
#X connect 17 0 4 0;
#X connect 17 1 5 0;
#X connect 18 0 19 0;
#X connect 18 1 20 0;
#X connect 18 2 4 1;
#X connect 20 0 31 0;
#X connect 21 0 20 1;
#X connect 22 0 0 0;
#X connect 26 0 18 0;
#X connect 26 1 21 0;
#X connect 29 0 4 1;
#X connect 29 1 16 0;
#X connect 29 2 30 0;
#X connect 30 0 20 1;
#X connect 31 1 1 0;
#X connect 31 1 12 0;
#X connect 33 0 32 0;
#X connect 34 0 1 1;
#X connect 34 0 13 0;
#X connect 34 1 1 2;
#X connect 34 1 14 0;
#X connect 34 2 1 3;
#X connect 34 2 27 0;
#X connect 34 2 28 0;
#X connect 34 3 1 4;
#X connect 34 3 15 0;
#X connect 34 4 33 0;
#X restore 134 339 pd SEPACHAIN-ANALYSIS;
#X obj 987 25 loadbang;
#X text 1123 154 aubioonset~ detect onsets aubiopitch~ detect pitch
aubiotempo~ detect tempo (beat tracking) aubiotss~ perform transient
/ steady-state separation aubioquiet~ detect silence aubiozcr~ compute
zero crossing rate;
#X text 1124 269 -t \, --onset-threshold thres Set the threshold value
for the onset peak picking. Values are typically in the range [0.001
\, 0.900]. Lower threshold values imply more onsets detected. Increasing
this threshold should reduce the number of incorrect detections. Defaults
to 0.3.;
#X msg 1127 243 aubiotempo~ <= aubioonset~;
#X msg 210 96 *TRIGSTART;
#X msg 323 95 *TRIGEND;
#X obj 1129 124 aubio;
#X obj 762 324 print ||TEMPER_RECEIVED_A_THRESHOLD;
#X obj 804 285 s \$0-AUBIO-THRESHOLD;
#X msg 987 51 0.3;
#X text 136 374 NOTE: aubiotempo is ok for complex situations \, but
not for exact diagnosis of clear percussive attacks, f 38;
#X obj 804 209 route aubio_threshold;
#X obj 352 166 s \$0-TRIGSTART;
#X obj 229 58 t b b;
#X obj 298 57 t b b;
#X obj 373 139 s \$0-TRIGEND;
#X obj 675 106 s \$0-INFILE;
#X obj 742 141 s \$0-OUTFILE;
#X obj 544 69 route trigstart trigend infile outfile;
#X obj 211 25 bang;
#X obj 324 25 bang;
#X obj 135 198 aubioonset~;
#X obj 276 137 print BEATER;
#X connect 0 0 29 0;
#X connect 2 0 7 0;
#X connect 3 0 2 1;
#X connect 4 0 3 0;
#X connect 5 0 26 0;
#X connect 8 0 17 0;
#X connect 12 0 30 0;
#X connect 13 0 30 0;
#X connect 17 0 16 0;
#X connect 19 0 15 0;
#X connect 19 0 16 0;
#X connect 19 0 29 1;
#X connect 19 1 7 1;
#X connect 21 0 20 0;
#X connect 21 1 4 0;
#X connect 22 0 23 0;
#X connect 22 1 13 0;
#X connect 26 0 27 0;
#X connect 26 1 28 0;
#X connect 26 2 24 0;
#X connect 26 3 25 0;
#X connect 26 4 19 0;
#X connect 27 0 12 0;
#X connect 27 0 21 0;
#X connect 28 0 22 0;
#X connect 29 0 2 0;
